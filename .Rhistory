prior(normal(0,5), class = "sd"),
prior(gamma(0.1, 0.1), class = "shape")),
warmup = 300, iter = 3000, chains = 3, cores = 3, thin=2,
control = list(adapt_delta = 0.98))
loo1_ZI.4 = loo(mod.brms.All1_ZI.4)
compare_ic(loo1, loo1_ZI, loo1_ZI.2, loo1_ZI.3, loo1_ZI.4)
save.image("~/GitHub/Hoeyetal2021_Survival/.RData")
compare_ic(loo1, loo1_ZI, loo1_ZI.2, loo1_ZI.3, loo1_ZI.4)
library(brms)
compare_ic(loo1, loo1_ZI, loo1_ZI.2, loo1_ZI.3, loo1_ZI.4)
compare_ic(loo2, loo2_ZI)
egg::ggarrange(pSC.1, pSC.2, ncol=2, widths = c(1.2,1))
pAll1.1
#Now Plot
pAll1.1 = ggplot(p2_ZIa, aes(y = (.value), x=habitat, fill = bite_on)) +
theme_bw(base_size = 12) +
stat_eye(alpha=0.7, position = position_dodge(width = 0.7), .width = c(0.5, 0.95)) +
# coord_cartesian(ylim= c(0,100)) +
geom_point(data=dat.bites.mod, aes(y=(TotalBites/3), x=habitat, colour=bite_on),
position = position_jitterdodge(jitter.width = 0.1),pch=1) +
stat_pointinterval(alpha=0.7, position = position_dodge(width = 0.7), .width = c(0.66, 0.95)) +
# stat_gradientinterval(position = "dodge") +
# scale_y_continuous(breaks = c(0.25, 0.5,0.75,1,1.25), limits = c(0.25,1.5)) +
scale_fill_manual(values=c("seagreen", "orange")) +
scale_colour_manual(values=c("seagreen", "orange")) +
coord_cartesian(ylim = c(0,200)) +
# scale_fill_viridis_d() +
# scale_y_log10() +
# scale_colour_viridis_d() +
theme(legend.position = "none",axis.title.x = element_blank(),axis.title.y = element_text(family="sans")) +
facet_wrap(~species, scales = "free_y", ncol = 1) +
ylab(expression(Number~of~bites~hr^{"-1"}~"\U00B1"~"95% quantile intervals"))
library(tidyverse)
pAll1.1
#Now Plot
pAll1.1 = ggplot(p2_ZIa, aes(y = (.value), x=habitat, fill = bite_on)) +
theme_bw(base_size = 12) +
stat_eye(alpha=0.7, position = position_dodge(width = 0.7), .width = c(0.5, 0.95)) +
# coord_cartesian(ylim= c(0,100)) +
geom_point(data=dat.bites.mod, aes(y=(TotalBites/3), x=habitat, colour=bite_on),
position = position_jitterdodge(jitter.width = 0.1),pch=1) +
stat_pointinterval(alpha=0.7, position = position_dodge(width = 0.7), .width = c(0.66, 0.95)) +
# stat_gradientinterval(position = "dodge") +
# scale_y_continuous(breaks = c(0.25, 0.5,0.75,1,1.25), limits = c(0.25,1.5)) +
scale_fill_manual(values=c("seagreen", "orange")) +
scale_colour_manual(values=c("seagreen", "orange")) +
coord_cartesian(ylim = c(0,200)) +
# scale_fill_viridis_d() +
# scale_y_log10() +
# scale_colour_viridis_d() +
theme(legend.position = "none",axis.title.x = element_blank(),axis.title.y = element_text(family="sans")) +
facet_wrap(~species, scales = "free_y", ncol = 1) +
ylab(expression(Number~of~bites~hr^{"-1"}~"\U00B1"~"95% quantile intervals"))
library(ggdist)
library(tidybayes)
#Now Plot
pAll1.1 = ggplot(p2_ZIa, aes(y = (.value), x=habitat, fill = bite_on)) +
theme_bw(base_size = 12) +
stat_eye(alpha=0.7, position = position_dodge(width = 0.7), .width = c(0.5, 0.95)) +
# coord_cartesian(ylim= c(0,100)) +
geom_point(data=dat.bites.mod, aes(y=(TotalBites/3), x=habitat, colour=bite_on),
position = position_jitterdodge(jitter.width = 0.1),pch=1) +
stat_pointinterval(alpha=0.7, position = position_dodge(width = 0.7), .width = c(0.66, 0.95)) +
# stat_gradientinterval(position = "dodge") +
# scale_y_continuous(breaks = c(0.25, 0.5,0.75,1,1.25), limits = c(0.25,1.5)) +
scale_fill_manual(values=c("seagreen", "orange")) +
scale_colour_manual(values=c("seagreen", "orange")) +
coord_cartesian(ylim = c(0,200)) +
# scale_fill_viridis_d() +
# scale_y_log10() +
# scale_colour_viridis_d() +
theme(legend.position = "none",axis.title.x = element_blank(),axis.title.y = element_text(family="sans")) +
facet_wrap(~species, scales = "free_y", ncol = 1) +
ylab(expression(Number~of~bites~hr^{"-1"}~"\U00B1"~"95% quantile intervals"))
pAll1.1
mod.brms.All1_ZI = brm(formula =TotalBites ~ bite_on*species +habitat + (1|site) +(1|id/Date),
data=dat.bites.mod, family=zero_inflated_negbinomial(), sample_prior = T,
prior = c(prior(normal(0, 5), class = "Intercept"),
prior(normal(0, 5), class = "b"),
prior(normal(0,5), class = "sd"),
prior(gamma(0.1, 0.1), class = "shape")),
warmup = 300, iter = 3000, chains = 3, cores = 3, thin=2,
control = list(adapt_delta = 0.98))
waic1_ZI = waic(mod.brms.All1_ZI)
loo1_ZI = loo(mod.brms.All1_ZI)
compare_ic(loo1, loo1_ZI, loo1_ZI.2, loo1_ZI.3, loo1_ZI.4)
# Scarus----
p1_ZI = dat.bites.mod %>%
modelr::data_grid(bite_on, species, site) %>%
add_epred_draws(mod.brms.All1_ZI, re_formula = NULL,  ndraws=1000) %>%
mutate(.epred = .epred/3)
p2_ZI = dat.bites.mod %>%
modelr::data_grid(bite_on,species, site) %>%
add_epred_draws(mod.brms.All1_ZI, re_formula = NULL, ndraws=100)  %>%
compare_levels(.epred, by = bite_on) %>%
mutate(.epred = .epred/3)
p2_ZIa = mod.brms.All1_ZI %>% emmeans(~ bite_on|species + habitat, type="response") %>%
gather_emmeans_draws(type="response") %>%
mutate(.value = exp(.value)/3)
library(emmeans)
p2_ZIa = mod.brms.All1_ZI %>% emmeans(~ bite_on|species + habitat, type="response") %>%
gather_emmeans_draws(type="response") %>%
mutate(.value = exp(.value)/3)
p2_ZIb = p2_ZIa %>% compare_levels(.value, by = bite_on)
#Now Plot
pAll1.1 = ggplot(p2_ZIa, aes(y = (.value), x=habitat, fill = bite_on)) +
theme_bw(base_size = 12) +
stat_eye(alpha=0.7, position = position_dodge(width = 0.7), .width = c(0.5, 0.95)) +
# coord_cartesian(ylim= c(0,100)) +
geom_point(data=dat.bites.mod, aes(y=(TotalBites/3), x=habitat, colour=bite_on),
position = position_jitterdodge(jitter.width = 0.1),pch=1) +
stat_pointinterval(alpha=0.7, position = position_dodge(width = 0.7), .width = c(0.66, 0.95)) +
# stat_gradientinterval(position = "dodge") +
# scale_y_continuous(breaks = c(0.25, 0.5,0.75,1,1.25), limits = c(0.25,1.5)) +
scale_fill_manual(values=c("seagreen", "orange")) +
scale_colour_manual(values=c("seagreen", "orange")) +
coord_cartesian(ylim = c(0,200)) +
# scale_fill_viridis_d() +
# scale_y_log10() +
# scale_colour_viridis_d() +
theme(legend.position = "none",axis.title.x = element_blank(),axis.title.y = element_text(family="sans")) +
facet_wrap(~species, scales = "free_y", ncol = 1) +
ylab(expression(Number~of~bites~hr^{"-1"}~"\U00B1"~"95% quantile intervals"))
pAll1.1
# Scarus----
p1_ZI = dat.bites.mod %>%
modelr::data_grid(bite_on, species, site) %>%
add_epred_draws(mod.brms.All1_ZI.3, re_formula = NULL,  ndraws=1000) %>%
mutate(.epred = .epred/3)
p2_ZI = dat.bites.mod %>%
modelr::data_grid(bite_on,species, site) %>%
add_epred_draws(mod.brms.All1_ZI.3, re_formula = NULL, ndraws=100)  %>%
compare_levels(.epred, by = bite_on) %>%
mutate(.epred = .epred/3)
p2_ZIa = mod.brms.All1_ZI.3 %>% emmeans(~ bite_on|species + habitat, type="response") %>%
gather_emmeans_draws(type="response") %>%
mutate(.value = exp(.value)/3)
p2_ZIb = p2_ZIa %>% compare_levels(.value, by = bite_on)
#Now Plot
pAll1.1 = ggplot(p2_ZIa, aes(y = (.value), x=habitat, fill = bite_on)) +
theme_bw(base_size = 12) +
stat_eye(alpha=0.7, position = position_dodge(width = 0.7), .width = c(0.5, 0.95)) +
# coord_cartesian(ylim= c(0,100)) +
geom_point(data=dat.bites.mod, aes(y=(TotalBites/3), x=habitat, colour=bite_on),
position = position_jitterdodge(jitter.width = 0.1),pch=1) +
stat_pointinterval(alpha=0.7, position = position_dodge(width = 0.7), .width = c(0.66, 0.95)) +
# stat_gradientinterval(position = "dodge") +
# scale_y_continuous(breaks = c(0.25, 0.5,0.75,1,1.25), limits = c(0.25,1.5)) +
scale_fill_manual(values=c("seagreen", "orange")) +
scale_colour_manual(values=c("seagreen", "orange")) +
coord_cartesian(ylim = c(0,200)) +
# scale_fill_viridis_d() +
# scale_y_log10() +
# scale_colour_viridis_d() +
theme(legend.position = "none",axis.title.x = element_blank(),axis.title.y = element_text(family="sans")) +
facet_wrap(~species, scales = "free_y", ncol = 1) +
ylab(expression(Number~of~bites~hr^{"-1"}~"\U00B1"~"95% quantile intervals"))
pAll1.1
#Now Plot
pAll1.1 = ggplot(p2_ZIa, aes(y = (.value), x=habitat, fill = bite_on)) +
theme_bw(base_size = 12) +
stat_eye(alpha=0.7, position = position_dodge(width = 0.7), .width = c(0.5, 0.95)) +
# coord_cartesian(ylim= c(0,100)) +
geom_point(data=dat.bites.mod, aes(y=(TotalBites/3), x=habitat, colour=bite_on),
position = position_jitterdodge(jitter.width = 0.1),pch=1) +
stat_pointinterval(alpha=0.7, position = position_dodge(width = 0.7), .width = c(0.66, 0.95)) +
# stat_gradientinterval(position = "dodge") +
# scale_y_continuous(breaks = c(0.25, 0.5,0.75,1,1.25), limits = c(0.25,1.5)) +
scale_fill_manual(values=c("seagreen", "orange")) +
scale_colour_manual(values=c("seagreen", "orange")) +
# coord_cartesian(ylim = c(0,200)) +
# scale_fill_viridis_d() +
# scale_y_log10() +
# scale_colour_viridis_d() +
theme(legend.position = "none",axis.title.x = element_blank(),axis.title.y = element_text(family="sans")) +
facet_wrap(~species, scales = "free_y", ncol = 1) +
ylab(expression(Number~of~bites~hr^{"-1"}~"\U00B1"~"95% quantile intervals"))
pAll1.1
pAll1.2 = ggplot(p2_ZIb, aes(x = .value, y = habitat)) +
# stat_eye(alpha=0.7, position = position_dodge(width = 0.7), .width = c(0.5, 0.95),side = "bottom") +
# stat_interval(alpha=0.7,.width = c(.50, .80, .95, .99)) +
# stat_interval(alpha=0.7, position = position_dodge(width = 0.7), .width = c(0.5, 0.95),side = "bottom") +
stat_pointinterval(alpha=0.7, .width = c(0.66, 0.95)) +
theme_bw(base_size = 12) +
geom_vline(xintercept=0, linetype="dashed") +
# scale_y_continuous(breaks = c(0.25, 0.5,0.75,1,1.25), limits = c(0.25,1.5)) +
# scale_x_log10() +
theme(legend.position = "right", axis.title.y = element_blank(),axis.text.y = element_blank(),
axis.title.x = element_blank()) +
facet_wrap(~species, scales="free", ncol=1)
pAll1.2
egg::ggarrange(pAll1.1, pAll1.2, ncol=2, widths = c(1.2,1))
egg::ggarrange(pAll1.1, pAll1.2, ncol=2, widths = c(1.2,1))
pAll1.2 = ggplot(p2_ZIb, aes(x = .value, y = habitat)) +
# stat_eye(alpha=0.7, position = position_dodge(width = 0.7), .width = c(0.5, 0.95),side = "bottom") +
# stat_interval(alpha=0.7,.width = c(.50, .80, .95, .99)) +
# stat_interval(alpha=0.7, position = position_dodge(width = 0.7), .width = c(0.5, 0.95),side = "bottom") +
stat_pointinterval(alpha=0.7, .width = c(0.66, 0.95)) +
theme_bw(base_size = 12) +
geom_vline(xintercept=0, linetype="dashed") +
# scale_y_continuous(breaks = c(0.25, 0.5,0.75,1,1.25), limits = c(0.25,1.5)) +
# scale_x_log10() +
theme(legend.position = "right", axis.title.y = element_blank(),
axis.title.x = element_blank()) +
facet_wrap(~species, scales="free", ncol=1)
egg::ggarrange(pAll1.1, pAll1.2, ncol=2, widths = c(1.2,1))
mod.brms.All2_ZI.3 = brm(formula =TotalBites ~ bite_on*species + (1|id/Date),
data=dat.bites.mod2, family=zero_inflated_negbinomial(), sample_prior = T,
prior = c(prior(normal(0, 5), class = "Intercept"),
prior(normal(0, 5), class = "b"),
prior(normal(0,5), class = "sd"),
prior(gamma(0.1, 0.1), class = "shape")),
warmup = 200, iter = 2000, chains = 3, cores = 3, thin=2,
control = list(adapt_delta = 0.98))
p1_ZI2 = dat.bites.mod %>%
modelr::data_grid(bite_on, species, site) %>%
add_epred_draws(mod.brms.All2_ZI.3, re_formula = NULL,  ndraws=1000) %>%
mutate(.epred = .epred/3)
p1_ZI2 = dat.bites.mod2 %>%
modelr::data_grid(bite_on, species, site) %>%
add_epred_draws(mod.brms.All2_ZI.3, re_formula = NULL,  ndraws=1000) %>%
mutate(.epred = .epred/3)
p2_ZI2 = dat.bites.mod2 %>%
modelr::data_grid(bite_on,species, site) %>%
add_epred_draws(mod.brms.All2_ZI.3, re_formula = NULL, ndraws=100)  %>%
compare_levels(.epred, by = bite_on) %>%
mutate(.epred = .epred/3)
p2_ZI2a = mod.brms.All2_ZI.3 %>% emmeans(~ bite_on|species + habitat, type="response") %>%
gather_emmeans_draws(type="response") %>%
mutate(.value = exp(.value)/3)
p2_ZI2a = mod.brms.All2_ZI.3 %>% emmeans(~ bite_on|species, type="response") %>%
gather_emmeans_draws(type="response") %>%
mutate(.value = exp(.value)/3)
p2_ZI2b = p2_ZI2a %>% compare_levels(.value, by = bite_on)
#Now Plot
pAll2.1 = ggplot(p2_ZI2a, aes(y = (.value), x=habitat, fill = bite_on)) +
theme_bw(base_size = 12) +
stat_eye(alpha=0.7, position = position_dodge(width = 0.7), .width = c(0.5, 0.95)) +
# coord_cartesian(ylim= c(0,100)) +
geom_point(data=dat.bites.mod, aes(y=(TotalBites/3), x=habitat, colour=bite_on),
position = position_jitterdodge(jitter.width = 0.1),pch=1) +
stat_pointinterval(alpha=0.7, position = position_dodge(width = 0.7), .width = c(0.66, 0.95)) +
# stat_gradientinterval(position = "dodge") +
# scale_y_continuous(breaks = c(0.25, 0.5,0.75,1,1.25), limits = c(0.25,1.5)) +
scale_fill_manual(values=c("seagreen", "orange")) +
scale_colour_manual(values=c("seagreen", "orange")) +
# coord_cartesian(ylim = c(0,200)) +
# scale_fill_viridis_d() +
# scale_y_log10() +
# scale_colour_viridis_d() +
theme(legend.position = "none",axis.title.x = element_blank(),axis.title.y = element_text(family="sans")) +
facet_wrap(~species, scales = "free_y", ncol = 1) +
ylab(expression(Number~of~bites~hr^{"-1"}~"\U00B1"~"95% quantile intervals"))
pAll2.1
p2_ZI2a = mod.brms.All2_ZI.3 %>% emmeans(~ bite_on|species, type="response") %>%
gather_emmeans_draws(type="response") %>%
mutate(.value = exp(.value)/3, habitat = "Crest")
p2_ZI2b = p2_ZI2a %>% compare_levels(.value, by = bite_on)
#Now Plot
pAll2.1 = ggplot(p2_ZI2a, aes(y = (.value), x=habitat, fill = bite_on)) +
theme_bw(base_size = 12) +
stat_eye(alpha=0.7, position = position_dodge(width = 0.7), .width = c(0.5, 0.95)) +
# coord_cartesian(ylim= c(0,100)) +
geom_point(data=dat.bites.mod, aes(y=(TotalBites/3), x=habitat, colour=bite_on),
position = position_jitterdodge(jitter.width = 0.1),pch=1) +
stat_pointinterval(alpha=0.7, position = position_dodge(width = 0.7), .width = c(0.66, 0.95)) +
# stat_gradientinterval(position = "dodge") +
# scale_y_continuous(breaks = c(0.25, 0.5,0.75,1,1.25), limits = c(0.25,1.5)) +
scale_fill_manual(values=c("seagreen", "orange")) +
scale_colour_manual(values=c("seagreen", "orange")) +
# coord_cartesian(ylim = c(0,200)) +
# scale_fill_viridis_d() +
# scale_y_log10() +
# scale_colour_viridis_d() +
theme(legend.position = "none",axis.title.x = element_blank(),axis.title.y = element_text(family="sans")) +
facet_wrap(~species, scales = "free_y", ncol = 1) +
ylab(expression(Number~of~bites~hr^{"-1"}~"\U00B1"~"95% quantile intervals"))
pAll2.1
#Now Plot
pAll2.1 = ggplot(p2_ZI2a, aes(y = (.value), x=habitat, fill = bite_on)) +
theme_bw(base_size = 12) +
stat_eye(alpha=0.7, position = position_dodge(width = 0.7), .width = c(0.5, 0.95)) +
# coord_cartesian(ylim= c(0,100)) +
geom_point(data=dat.bites.mod, aes(y=(TotalBites/3), x=habitat, colour=bite_on),
position = position_jitterdodge(jitter.width = 0.1),pch=1) +
stat_pointinterval(alpha=0.7, position = position_dodge(width = 0.7), .width = c(0.66, 0.95)) +
# stat_gradientinterval(position = "dodge") +
# scale_y_continuous(breaks = c(0.25, 0.5,0.75,1,1.25), limits = c(0.25,1.5)) +
scale_fill_manual(values=c("seagreen", "orange")) +
scale_colour_manual(values=c("seagreen", "orange")) +
# coord_cartesian(ylim = c(0,200)) +
# scale_fill_viridis_d() +
# scale_y_log10() +
# scale_colour_viridis_d() +
theme(legend.position = "none",axis.title.x = element_blank(),axis.title.y = element_text(family="sans")) +
facet_wrap(~species, scales = "free_y", ncol = 1) +
ylab(expression(Number~of~bites~hr^{"-1"}~"\U00B1"~"95% quantile intervals"))
pAll2.1
#Now Plot
pAll2.1 = ggplot(p2_ZI2a, aes(y = (.value), x=habitat, fill = bite_on)) +
theme_bw(base_size = 12) +
stat_eye(alpha=0.7, position = position_dodge(width = 0.7), .width = c(0.5, 0.95)) +
# coord_cartesian(ylim= c(0,100)) +
geom_point(data=dat.bites.mod2, aes(y=(TotalBites/3), x=habitat, colour=bite_on),
position = position_jitterdodge(jitter.width = 0.1),pch=1) +
stat_pointinterval(alpha=0.7, position = position_dodge(width = 0.7), .width = c(0.66, 0.95)) +
# stat_gradientinterval(position = "dodge") +
# scale_y_continuous(breaks = c(0.25, 0.5,0.75,1,1.25), limits = c(0.25,1.5)) +
scale_fill_manual(values=c("seagreen", "orange")) +
scale_colour_manual(values=c("seagreen", "orange")) +
# coord_cartesian(ylim = c(0,200)) +
# scale_fill_viridis_d() +
# scale_y_log10() +
# scale_colour_viridis_d() +
theme(legend.position = "none",axis.title.x = element_blank(),axis.title.y = element_text(family="sans")) +
facet_wrap(~species, scales = "free_y", ncol = 1) +
ylab(expression(Number~of~bites~hr^{"-1"}~"\U00B1"~"95% quantile intervals"))
pAll2.1
pAll2.2 = ggplot(p2_ZI2b, aes(x = .value, y = habitat)) +
# stat_eye(alpha=0.7, position = position_dodge(width = 0.7), .width = c(0.5, 0.95),side = "bottom") +
# stat_interval(alpha=0.7,.width = c(.50, .80, .95, .99)) +
# stat_interval(alpha=0.7, position = position_dodge(width = 0.7), .width = c(0.5, 0.95),side = "bottom") +
stat_pointinterval(alpha=0.7, .width = c(0.66, 0.95)) +
theme_bw(base_size = 12) +
geom_vline(xintercept=0, linetype="dashed") +
# scale_y_continuous(breaks = c(0.25, 0.5,0.75,1,1.25), limits = c(0.25,1.5)) +
# scale_x_log10() +
theme(legend.position = "right", axis.title.y = element_blank(),
axis.title.x = element_blank()) +
facet_wrap(~species, scales="free", ncol=1)
egg::ggarrange(pAll2.1, pAll2.2, ncol=2, widths = c(1.2,1))
p2_ZI2b = p2_ZI2a %>% compare_levels(.value, by = bite_on) %>%
mutate( habitat = "Crest")
pAll2.2 = ggplot(p2_ZI2b, aes(x = .value, y = habitat)) +
# stat_eye(alpha=0.7, position = position_dodge(width = 0.7), .width = c(0.5, 0.95),side = "bottom") +
# stat_interval(alpha=0.7,.width = c(.50, .80, .95, .99)) +
# stat_interval(alpha=0.7, position = position_dodge(width = 0.7), .width = c(0.5, 0.95),side = "bottom") +
stat_pointinterval(alpha=0.7, .width = c(0.66, 0.95)) +
theme_bw(base_size = 12) +
geom_vline(xintercept=0, linetype="dashed") +
# scale_y_continuous(breaks = c(0.25, 0.5,0.75,1,1.25), limits = c(0.25,1.5)) +
# scale_x_log10() +
theme(legend.position = "right", axis.title.y = element_blank(),
axis.title.x = element_blank()) +
facet_wrap(~species, scales="free", ncol=1)
egg::ggarrange(pAll2.1, pAll2.2, ncol=2, widths = c(1.2,1))
egg::ggarrange(pAll2.1, pAll2.2, ncol=2, widths = c(1.2,1))
#Now Plot
pAll2.1 = ggplot(p2_ZI2a, aes(y = (.value), x=habitat, fill = bite_on)) +
theme_bw(base_size = 12) +
stat_eye(alpha=0.7, position = position_dodge(width = 0.7), .width = c(0.5, 0.95)) +
# coord_cartesian(ylim= c(0,100)) +
geom_point(data=dat.bites.mod2, aes(y=(TotalBites/3), x=habitat, colour=bite_on),
position = position_jitterdodge(jitter.width = 0.1),pch=1) +
stat_pointinterval(alpha=0.7, position = position_dodge(width = 0.7), .width = c(0.66, 0.95)) +
# stat_gradientinterval(position = "dodge") +
# scale_y_continuous(breaks = c(0.25, 0.5,0.75,1,1.25), limits = c(0.25,1.5)) +
scale_fill_manual(values=c("seagreen", "orange")) +
scale_colour_manual(values=c("seagreen", "orange")) +
coord_cartesian(ylim = c(0,5)) +
# scale_fill_viridis_d() +
# scale_y_log10() +
# scale_colour_viridis_d() +
theme(legend.position = "none",axis.title.x = element_blank(),axis.title.y = element_text(family="sans")) +
facet_wrap(~species, scales = "free_y", ncol = 1) +
ylab(expression(Number~of~bites~hr^{"-1"}~"\U00B1"~"95% quantile intervals"))
library(tidyverse)
#Now Plot
pAll2.1 = ggplot(p2_ZI2a, aes(y = (.value), x=habitat, fill = bite_on)) +
theme_bw(base_size = 12) +
stat_eye(alpha=0.7, position = position_dodge(width = 0.7), .width = c(0.5, 0.95)) +
# coord_cartesian(ylim= c(0,100)) +
geom_point(data=dat.bites.mod2, aes(y=(TotalBites/3), x=habitat, colour=bite_on),
position = position_jitterdodge(jitter.width = 0.1),pch=1) +
stat_pointinterval(alpha=0.7, position = position_dodge(width = 0.7), .width = c(0.66, 0.95)) +
# stat_gradientinterval(position = "dodge") +
# scale_y_continuous(breaks = c(0.25, 0.5,0.75,1,1.25), limits = c(0.25,1.5)) +
scale_fill_manual(values=c("seagreen", "orange")) +
scale_colour_manual(values=c("seagreen", "orange")) +
coord_cartesian(ylim = c(0,5)) +
# scale_fill_viridis_d() +
# scale_y_log10() +
# scale_colour_viridis_d() +
theme(legend.position = "none",axis.title.x = element_blank(),axis.title.y = element_text(family="sans")) +
facet_wrap(~species, scales = "free_y", ncol = 1) +
ylab(expression(Number~of~bites~hr^{"-1"}~"\U00B1"~"95% quantile intervals"))
library(ggdist)
#Now Plot
pAll2.1 = ggplot(p2_ZI2a, aes(y = (.value), x=habitat, fill = bite_on)) +
theme_bw(base_size = 12) +
stat_eye(alpha=0.7, position = position_dodge(width = 0.7), .width = c(0.5, 0.95)) +
# coord_cartesian(ylim= c(0,100)) +
geom_point(data=dat.bites.mod2, aes(y=(TotalBites/3), x=habitat, colour=bite_on),
position = position_jitterdodge(jitter.width = 0.1),pch=1) +
stat_pointinterval(alpha=0.7, position = position_dodge(width = 0.7), .width = c(0.66, 0.95)) +
# stat_gradientinterval(position = "dodge") +
# scale_y_continuous(breaks = c(0.25, 0.5,0.75,1,1.25), limits = c(0.25,1.5)) +
scale_fill_manual(values=c("seagreen", "orange")) +
scale_colour_manual(values=c("seagreen", "orange")) +
coord_cartesian(ylim = c(0,5)) +
# scale_fill_viridis_d() +
# scale_y_log10() +
# scale_colour_viridis_d() +
theme(legend.position = "none",axis.title.x = element_blank(),axis.title.y = element_text(family="sans")) +
facet_wrap(~species, scales = "free_y", ncol = 1) +
ylab(expression(Number~of~bites~hr^{"-1"}~"\U00B1"~"95% quantile intervals"))
egg::ggarrange(pAll2.1, pAll2.2, ncol=2, widths = c(1.2,1))
#Now Plot
pAll2.1 = ggplot(p2_ZI2a, aes(y = (.value), x=habitat, fill = bite_on)) +
theme_bw(base_size = 12) +
stat_eye(alpha=0.7, position = position_dodge(width = 0.7), .width = c(0.5, 0.95)) +
# coord_cartesian(ylim= c(0,100)) +
geom_point(data=dat.bites.mod2, aes(y=(TotalBites/3), x=habitat, colour=bite_on),
position = position_jitterdodge(jitter.width = 0.1),pch=1) +
stat_pointinterval(alpha=0.7, position = position_dodge(width = 0.7), .width = c(0.66, 0.95)) +
# stat_gradientinterval(position = "dodge") +
# scale_y_continuous(breaks = c(0.25, 0.5,0.75,1,1.25), limits = c(0.25,1.5)) +
scale_fill_manual(values=c("seagreen", "orange")) +
scale_colour_manual(values=c("seagreen", "orange")) +
coord_cartesian(ylim = c(0,5)) +
# scale_fill_viridis_d() +
# scale_y_log10() +
# scale_colour_viridis_d() +
theme(legend.position = "bottom",axis.title.x = element_blank(),axis.title.y = element_text(family="sans")) +
facet_wrap(~species, scales = "free_y", ncol = 1) +
ylab(expression(Number~of~bites~hr^{"-1"}~"\U00B1"~"95% quantile intervals"))
egg::ggarrange(pAll2.1, pAll2.2, ncol=2, widths = c(1.2,1))
egg::ggarrange(pAll2.1, pAll2.2, ncol=2, widths = c(1.2,1))
mod.brms.bites.2 = brm(formula =TotalBites ~ bite_on*habitat  + (1|Date/site),
data=dat.bites.sum, family="negbinomial", sample_prior = T,
# prior = m1priors,
prior = c(prior(normal(0, 5), class = "Intercept"),
prior(normal(0, 5), class = "b"),
prior(student_t(3, 0, 2.5), class = "sd"),
prior(gamma(0.1, 0.1), class = "shape")),
warmup = 200, iter = 2000, chains = 3, cores = 3, thin=2,
control = list(adapt_delta = 0.98)
#                max_treedepth=15)
)
library(brms)
mod.brms.bites.2 = brm(formula =TotalBites ~ bite_on*habitat  + (1|Date/site),
data=dat.bites.sum, family="negbinomial", sample_prior = T,
# prior = m1priors,
prior = c(prior(normal(0, 5), class = "Intercept"),
prior(normal(0, 5), class = "b"),
prior(student_t(3, 0, 2.5), class = "sd"),
prior(gamma(0.1, 0.1), class = "shape")),
warmup = 200, iter = 2000, chains = 3, cores = 3, thin=2,
control = list(adapt_delta = 0.98)
#                max_treedepth=15)
)
mod.brms.bites.2 = brm(formula =TotalBites ~ bite_on*habitat  + (1|Date/site),
data=dat.bites.sum, family="negbinomial", sample_prior = T,
# prior = m1priors,
prior = c(prior(normal(0, 5), class = "Intercept"),
prior(normal(0, 5), class = "b"),
prior(student_t(3, 0, 2.5), class = "sd"),
prior(gamma(0.1, 0.1), class = "shape")),
warmup = 200, iter = 2000, chains = 3, cores = 3, thin=2,
control = list(adapt_delta = 0.98)
#                max_treedepth=15)
)
mod.brms.bites.3 = brm(formula =TotalBites ~ bite_on*habitat  + (1|Date),
data=dat.bites.sum, family="negbinomial", sample_prior = T,
# prior = m1priors,
prior = c(prior(normal(0, 5), class = "Intercept"),
prior(normal(0, 5), class = "b"),
prior(student_t(3, 0, 2.5), class = "sd"),
prior(gamma(0.1, 0.1), class = "shape")),
warmup = 200, iter = 2000, chains = 3, cores = 3, thin=2,
control = list(adapt_delta = 0.98)
#                max_treedepth=15)
)
mod.brms.bites.4 = brm(formula =TotalBites ~ bite_on*habitat + (1|site),
data=dat.bites.sum, family="negbinomial", sample_prior = T,
# prior = m1priors,
prior = c(prior(normal(0, 5), class = "Intercept"),
prior(normal(0, 5), class = "b"),
prior(student_t(3, 0, 2.5), class = "sd"),
prior(gamma(0.1, 0.1), class = "shape")),
warmup = 200, iter = 2000, chains = 3, cores = 3, thin=2,
control = list(adapt_delta = 0.98)
#                max_treedepth=15)
)
mod.brms.bites.5 = brm(formula =TotalBites ~ bite_on*habitat,
data=dat.bites.sum, family="negbinomial", sample_prior = T,
# prior = m1priors,
prior = c(prior(normal(0, 5), class = "Intercept"),
prior(normal(0, 5), class = "b"),
prior(student_t(3, 0, 2.5), class = "sd"),
prior(gamma(0.1, 0.1), class = "shape")),
warmup = 200, iter = 2000, chains = 3, cores = 3, thin=2,
control = list(adapt_delta = 0.98)
#                max_treedepth=15)
)
mod.brms.bites.5 = brm(formula =TotalBites ~ bite_on*habitat,
data=dat.bites.sum, family="negbinomial", sample_prior = T,
# prior = m1priors,
prior = c(prior(normal(0, 5), class = "Intercept"),
prior(normal(0, 5), class = "b"),
# prior(student_t(3, 0, 2.5), class = "sd"),
prior(gamma(0.1, 0.1), class = "shape")),
warmup = 200, iter = 2000, chains = 3, cores = 3, thin=2,
control = list(adapt_delta = 0.98)
#                max_treedepth=15)
)
mod.brm2 = add_criterion(mod.brms.bites.2,  "loo")
mod.brm3 = add_criterion(mod.brms.bites.3,  "loo")
mod.brm4 = add_criterion(mod.brms.bites.4,  "loo")
mod.brm5 = add_criterion(mod.brms.bites.5,  "loo")
loo::loo_compare(mod.brm2,  mod.brm3, mod.brm4, mod.brm5, criterion = "loo")
emmeans::emmeans(mod.brms.bites2,~ bite_on|habitat, type="response")
